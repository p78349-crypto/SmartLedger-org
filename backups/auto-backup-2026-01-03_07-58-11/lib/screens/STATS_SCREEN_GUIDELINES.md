# 사용자 통계 화면 출력 가이드라인

## 1. 화면 구조

### 1.1 전체 레이아웃
```
[AppBar]
  - 제목: "{계정명} 통계"
  - 액션: 검색 버튼

[Body]
  - RefreshIndicator (당겨서 새로고침)
  - SingleChildScrollView
    - 필터 칩 영역
    - 통계 콘텐츠 영역
```

### 1.2 여백 기준
- 전체 패딩: `16px` (좌우), `16px` (상), `24px` (하)
- 필터 칩과 통계 콘텐츠 간격: `20px`
- 섹션 간 간격: `16px`
- 카드 내부 패딩: `16px`

## 2. 필터 영역

### 2.1 거래 유형 버튼 (Row)
- **균등 분할**: 3개 버튼이 가로 공간을 1:1:1로 균등 분할
- **버튼 종류**:
  - 지출 (Expense)
  - 수입 (Income)
  - 예금 (Savings)
- **버튼 간격**: `8px`
- **선택 상태**: ElevatedButton (선택), OutlinedButton (미선택)

### 2.2 기간 선택 칩 (Row)
- **스크롤 가능**: SingleChildScrollView (horizontal)
- **칩 종류**:
  - 월별 (Month)
  - 분기별 (Quarter)
  - 반기별 (Half Year)
  - 연도별 (Year)
  - 10년별 (Decade)
  - 차트 (Chart)
- **칩 간격**: `8px`
- **선택 상태**: 
  - 선택: primary color 배경
  - 미선택: outline 스타일

## 3. 통계 표시 형식

### 3.1 숫자 포맷
- **통화**: `NumberFormat('#,##0')` - 천단위 콤마, 소수점 없음
- **콤팩트**: `NumberFormat.compact(locale: 'ko')` - 만원, 억원 단위
- **예시**:
  - 1000000 → 1,000,000
  - 10000000 → 1000만 (콤팩트)

### 3.2 날짜 포맷
- **전체 날짜**: `yyyy-MM-dd` (예: 2025-12-05)
- **월 레이블**: (중복 표기 방지를 위해 UI에서는 기본적으로 제거)
- **범위 월**: `yyyy.MM` (예: 2025.12)
- **짧은 월**: `M월` (예: 12월)
- **일 레이블**: `M월 d일` (예: 12월 5일)

### 3.3 색상 구분
- **지출**: `theme.colorScheme.error` (빨강 계열)
- **수입**: `theme.colorScheme.primary` (파랑 계열)
- **예금**: `theme.colorScheme.tertiary` (보라 계열)

## 4. 차트 표시

### 4.1 차트 종류
1. **막대 차트 (Bar Chart)**
   - 기본 차트 타입
   - 막대 너비: 14px
   - 모서리 반경: 4px
   
2. **선 차트 (Line Chart)**
   - 선 너비: 2.5px
   - 점 크기: 6px (선택된 점은 8px)
   
3. **파이 차트 (Pie Chart)**
   - 중앙 구멍 반경: 40%
   - 섹션 간격: 2px

### 4.2 차트 레이아웃
- **최소 높이**: `200px`
- **최대 높이**: `300px`
- **좌우 여백**: `8px`
- **Y축 레이블**: 콤팩트 포맷 사용

## 5. 월별/기간별 통계 카드

### 5.1 카드 구조
```
[Card]
  [헤더]
    - 기간 (예: "12/01 ~ 12/31")
    - 네비게이션 버튼 (이전/다음)
  
  [본문]
    - 총 금액
    - 거래 건수
    - 평균 금액
    - (옵션) 고정비 포함 여부
```

### 5.2 정렬 기준
- **월별/분기별**: 최신 월/분기 → 과거 순
- **연도별**: 최신 연도 → 과거 순
- **10년별**: 최신 10년 → 과거 순

## 6. 상세 거래 목록

### 6.1 거래 항목 표시
```
[ListTile]
  - Leading: 아이콘 (거래 유형)
  - Title: 거래처 이름
  - Subtitle: 날짜
  - Trailing: 금액
    - 지출: -1,000,000
    - 수입: +1,000,000
    - 예금: 1,000,000
```

### 6.2 빈 상태
- 메시지: "등록된 거래가 없습니다."
- 중앙 정렬
- 회색 텍스트

## 7. 반응형 디자인

### 7.1 너비 기준
- **좁은 화면** (< 320px): 1열 그리드
- **일반 화면** (≥ 320px): 2열 그리드
- **넓은 화면**: 최대 너비 제한 고려

### 7.2 버튼 크기
- **최소 높이**: `48px` (터치 영역 확보)
- **텍스트 크기**: 기본 theme 사용
- **아이콘 크기**: `24px` (일반), `26px` (강조)

## 8. 인터랙션

### 8.1 새로고침
- **당겨서 새로고침** 지원
- 로딩 시: CircularProgressIndicator 표시

### 8.2 기간 네비게이션
- **이전/다음 버튼**: IconButton (< / >)
- **직접 선택**: 기간 텍스트 탭 시 DatePicker 표시

### 8.3 차트 전환
- **버튼**: 막대/선/파이 아이콘
- **애니메이션**: 부드러운 전환 효과

## 9. 성능 최적화

### 9.1 데이터 로딩
- 초기 로딩: `_isInitializing` 플래그 사용
- 비동기 로딩: `Future.wait()` 활용
- 캐싱: Service 레이어에서 관리

### 9.2 목록 렌더링
- **ListView.builder** 사용 (긴 목록)
- **ListView.separated** 사용 (구분선 필요 시)
- **shrinkWrap**: 중첩 스크롤 필요 시만 사용

## 10. 접근성

### 10.1 시맨틱 레이블
- 모든 IconButton에 `tooltip` 제공
- 차트에 대체 텍스트 제공

### 10.2 색상 대비
- 텍스트: theme의 기본 색상 사용
- 충분한 대비율 확보 (WCAG AA 기준)

### 10.3 터치 영역
- 최소 터치 영역: 48x48px
- 버튼 간 충분한 간격 확보

## 11. 에러 처리

### 11.1 데이터 없음
- 친절한 안내 메시지 표시
- 액션 버튼 제공 (예: "거래 추가하기")

### 11.2 로딩 실패
- 에러 메시지 표시
- 재시도 버튼 제공

## 12. 고정비 처리

### 12.1 고정비 포함 옵션
- **토글 스위치**: 고정비 포함/제외
- **표시 방식**: 
  - 포함: 고정비 + 실제 거래
  - 제외: 실제 거래만

### 12.2 시각적 구분
- 고정비 항목: 별도 아이콘 또는 색상
- 설명 텍스트: "고정비 포함" 표시

## 체크리스트

통계 화면 구현 시 확인사항:

- [ ] 3개 거래 유형 버튼이 균등 분할되어 있는가?
- [ ] 버튼 간격이 일정한가? (8px)
- [ ] 숫자 포맷이 일관성 있게 적용되었는가?
- [ ] 색상이 거래 유형에 맞게 구분되어 있는가?
- [ ] 차트가 반응형으로 동작하는가?
- [ ] 빈 상태 메시지가 표시되는가?
- [ ] 로딩 인디케이터가 작동하는가?
- [ ] 당겨서 새로고침이 가능한가?
- [ ] 모든 버튼에 tooltip이 있는가?
- [ ] 터치 영역이 충분한가? (최소 48px)

---

**마지막 업데이트**: 2025-12-05
**파일 위치**: `lib/screens/account_stats_screen.dart`
