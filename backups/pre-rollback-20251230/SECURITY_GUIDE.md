# 보안/암호 설정 및 동작 설명

**목적**: 자산/ROOT 보안(기기 인증)과 백업/복원 암호화의 “설정 방법 + 동작 방식”을 한 곳에 정리합니다.

---

## 1) 자산 보안(기기 인증) — 설정 방법

- 위치: 자산 화면(AssetTabScreen) 내 보안 설정 영역
- 동작:
  - ON: 자산 관련 정보/기능 접근 시 기기 인증(생체/기기 잠금)을 요구합니다.
  - OFF: 자산/ROOT 보안이 해제되어 인증 없이 접근됩니다.

### 인증(잠금 해제) 방법
- 자산 기능 접근 시 OS 기기 인증(지문/얼굴/기기 PIN 등) 프롬프트가 뜹니다.
- 인증이 성공하면 “잠금 해제 세션”이 짧게 유지됩니다.

### 자동 잠금(세션) 규칙
- 자산 보안 ON + 인증 성공 상태에서 일정 시간 미사용 시 자동 잠금됩니다.
- 현재 세션 타임아웃: **1분**

---

## 2) ROOT 보안 — 통합/별도 모드(유저 선택)

- ROOT 보안은 **자산 보안이 ON일 때만** 의미가 있습니다.
- 설정 위치: 자산 화면(AssetTabScreen) 내 “ROOT 보안” 옵션

### 모드 1: 통합 사용(`integrated`)
- 의미: ROOT 진입 시, 자산 인증 세션을 그대로 사용합니다.
- 동작:
  - 자산 세션이 없으면 ROOT 진입 시 인증 1회가 필요합니다.
  - 자산 세션이 살아있으면 추가 인증 없이 ROOT 화면이 열립니다.

### 모드 2: 별도 사용(`separate`)
- 의미: ROOT는 자산 인증과 별도로 “추가 인증(2단계)”을 한 번 더 요구합니다.
- 동작:
  - (1단계) 자산 세션이 없으면 먼저 자산 인증을 진행합니다.
  - (2단계) ROOT 세션이 없으면 ROOT 추가 인증을 한 번 더 진행합니다.

### 인증 위치(역할 분리)
- ROOT 인증은 라우터가 아니라, **각 ROOT 화면 내부에서** `RootAuthGate`로 처리됩니다.
- 따라서 ROOT 관련 화면에 진입할 때마다 해당 화면이 필요 시 인증을 요구합니다.

---

## 3) 백업/복원 — 암호 설정 및 동작

### 백업 화면에서 보안 옵션 설정
- 위치: “백업/복원” 화면(BackupScreen)
- 옵션:
  - **백업 암호화(암호 필요)**: ON 시 백업 파일이 암호화됩니다.
  - **2단계 보호(기기 인증 추가)**: 암호화 ON일 때만 선택 가능. 복원 시 기기 인증을 추가로 요구합니다.

### 백업 시 암호 설정(암호화 ON)
- 백업 생성 버튼을 누르면 “백업 암호 설정” 다이얼로그가 뜹니다.
- 규칙:
  - 암호는 **4자 이상**
  - 암호 확인(2번 입력) 일치 필요
- 중요:
  - 이 암호는 **백업 파일 복원에 필요**합니다.
  - 암호를 잊어버리면 해당 암호화 백업은 복원할 수 없습니다.

### 복원 시 암호 입력(암호화 백업)
- 복원하려는 파일이 암호화 백업이면, 복원 과정에서 암호 입력이 필요합니다.
- 암호가 없거나 틀리면 복원이 실패합니다.

### 2단계 보호(기기 인증 추가) 동작
- 2단계 보호가 ON이고, 암호화 백업을 복원하는 경우:
  - (1) 백업 암호 입력 후
  - (2) OS 기기 인증(지문/얼굴/기기 PIN 등) 프롬프트를 추가로 요구합니다.

### 자동 백업과 암호화 옵션
- 백업 암호화가 ON인 경우, **자동 백업은 동작하지 않습니다**(암호 입력이 필요하므로 무인 자동화를 스킵).

---

## 빠른 점검(FAQ)

- Q) 암호화 백업 암호를 잊어버리면?
  - A) 복원이 불가능합니다(암호 재설정/복구 기능 없음).
- Q) 기기 인증을 지원하지 않는 기기라면?
  - A) 자산/ROOT의 기기 인증, 백업 2단계 보호 기능을 사용할 수 없습니다.

---

## 4) 지적재산권(IP) / 오픈소스 라이선스 점검 기록

- 본 프로젝트의 3rd-party(Flutter/Dart 패키지) 사용 및 라이선스 파일 스캔 결과는 다음 문서에 기록합니다:
  - docs/IP_COMPLIANCE_CHECK_2025-12-27.md
  - docs/THIRD_PARTY_LICENSES_SUMMARY.md (자동 생성)
- 자동 생성 방법:
  - dart run tools/generate_third_party_licenses_summary.dart
