# I18N 데이터 저장/표시 전략 — 리스크 평가 (2025-12-29)

## 목표/전제
- 목표: 앱 언어를 변경해도 동일한 거래/통계 데이터를 **일관되게 노출**.
- 전제: 언어(ko/en/ja)는 **UI 표시 정책**이며, 거래 데이터는 장기 보관/백업/통계 집계 대상.
- 핵심 원칙(권장): **저장 = 중립(언어 비의존)**, **표시 = 로케일(언어 의존)**.

---

## 선택지 비교

### A) 언어별 문자열을 그대로 저장하고 그대로 표시
예: 카테고리를 `식비`로 저장, 영어 UI여도 `식비`로 표시
- 장점
  - 구현이 가장 쉽고 빠름
  - 마이그레이션 부담이 적음
- 단점/리스크
  - 언어 변경 시 UI가 혼합됨(영어 UI + 한국어 데이터)
  - 다국어 검색(예: Food로 검색)과 충돌 가능
  - 통계/추천/필터를 언어 중립적으로 발전시키기 어려움
- 결론
  - **단기 임시**로는 가능하나, 다국어 확장/제품 완성도 관점에서는 한계가 큼

### B) 중립 키로 저장 + 언어별 라벨로 표시(권장)
예: `categoryKey=food` 저장 → ko: `식비`, en: `Food`, ko 병기: `식비 (Food)`
- 장점
  - 언어 변경에도 동일 데이터가 해당 언어로 자연스럽게 표시됨
  - 통계/검색/필터/추천이 안정적(키 기반)
  - 번역 문구를 변경해도 데이터는 영향 없음
- 단점/리스크
  - **키 체계 설계**가 필요(한 번 정하면 쉽게 바꾸기 어려움)
  - 기존 데이터가 문자열 기반이라면 **매핑/마이그레이션**이 필요
  - 커스텀 카테고리/오타/동의어 처리 정책이 필요
- 결론
  - 다국어를 진지하게 가져가면 결국 이 방식으로 수렴

### C) 국가/언어별 별도 저장소(공간) 분리
예: KR 저장소/US 저장소를 완전히 분리
- 장점
  - 법/컴플라이언스 요구(국가별 보관/정책)가 있으면 명확
  - 통화/세금 규칙이 완전히 다른 장부를 분리 운영하기 쉬움
- 단점/리스크
  - 언어 전환 시 데이터가 “사라진 것처럼 보임” (저장소가 달라짐)
  - 백업/복원/이관/통합 통계가 복잡
  - UX 혼란(사용자는 언어=표시라고 생각하는 경향)
- 결론
  - “언어 변경”과 연동시키면 위험. 분리 필요 시 **프로필/장부 선택 UX**로 분리 권장

---

## 리스크 매트릭스(요약)
- 데이터 일관성: A(중간) / B(낮음) / C(높음)
- 구현 난이도: A(낮음) / B(중간~높음) / C(높음)
- 유지보수 난이도: A(중간) / B(중간) / C(높음)
- 사용자 혼란: A(중간) / B(낮음) / C(높음)

---

## 안전한 진행 로드맵(권장: “가장 안전 + 합법 대비 + 유지보수 리스크 관리”)

### 1단계 (DB 변경 없이) — 표시 전용 번역 레이어
- 거래 데이터(카테고리 등) 저장 형식은 유지
- UI에서만 “표시 라벨”을 언어에 따라 변환(필요하면 병기)
- 장점: 데이터/백업 포맷 변경 없음 → 리스크 최소

### 2단계 (점진) — 중립 키 도입(새 데이터부터)
- 새로 저장되는 거래부터 `categoryKey` 같은 중립 키를 추가 저장
- 기존 데이터는 즉시 변환하지 않고, 필요 시 점진 변환(읽을 때/편집할 때)
- 장점: 마이그레이션 충격 최소화

### 3단계 (선택) — 기존 데이터 일괄 마이그레이션
- 매핑 정확도/로그/롤백 계획이 준비되면 수행
- 백업/복원/버전 호환(스키마 버전)을 같이 정의

---

## 정책 결정 체크리스트(결정이 필요한 항목)
- 언어 변경 시 카테고리/데이터 표시 정책: 
  - ( ) 영어만 표시
  - ( ) 한국어(영어) 병기
  - ( ) 커스텀 카테고리는 원문 유지
- 키 설계 방식:
  - ( ) 고정 enum 키(권장)
  - ( ) 사용자 정의 키 허용(추가 정책 필요)
- 검색 정책:
  - ( ) 키 기반 검색
  - ( ) 번역/동의어 검색 지원(추가 인덱싱)

---

## 현재 코드 상태 메모(2025-12-29)
- 메뉴/아이콘 라벨은 `labelEn`(옵션) + `labelFor(context)`로
  - ko: `한국어 (English)` 병기 가능
  - en: 영어 우선, 없으면 한국어 fallback
- 다음 후보: 거래 카테고리/통계 화면의 카테고리 문자열 처리
