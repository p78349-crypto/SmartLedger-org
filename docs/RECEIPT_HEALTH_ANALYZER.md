# 영수증 재료 건강도 간편 평가 시스템

## 📋 개요

영수증에 있는 재료들을 **클릭 몇 번**으로 건강 점수를 즉시 확인할 수 있는 시스템입니다.

## 🎯 주요 기능

### 1. 즉시 건강 점수 표시
- 재료 입력하면 **실시간으로** 건강 점수 계산
- 1점(비건강) ~ 5점(매우 건강) 척도
- 색상으로 한눈에 확인 (녹색=건강, 빨강=주의)

### 2. 재료별 점수 자동 분석
```
💚 양배추: 5점 - 매우 건강
💚 브로콜리: 5점 - 매우 건강
💚 느타리버섯: 5점 - 매우 건강
🟡 닭고기: 3점 - 보통
🔴 닭튀김당: 1점 - 비건강 (튀김)
```

### 3. 전체 영수증 평가
- 모든 재료의 평균 건강 점수
- 건강한 재료 비율 (%)
- 개선 제안 메시지

## 🏃 빠른 시작

### 방법 1: 간편 분석 화면 (추천)
```dart
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (_) => QuickHealthAnalyzerScreen(),
  ),
);
```

**특징:**
- ✅ 영수증 재료가 미리 입력되어 있음
- ✅ 체크박스로 간편하게 선택/해제
- ✅ 실시간으로 점수 변화 확인
- ✅ 재료별 건강도 한눈에 보기

### 방법 2: 다이얼로그 (커스텀 분석)
```dart
await showDialog(
  context: context,
  builder: (_) => IngredientHealthAnalyzerDialog(),
);
```

**특징:**
- ✅ 자유롭게 재료 추가/삭제
- ✅ 영수증 외 재료도 분석 가능
- ✅ 빠른 입력 (Enter로 추가)

## 💡 사용 예시

### 예시 1: 영수증 전체 평가
```
영수증 재료:
- 양배추, 브로콜리, 당근, 호박 (채소 4개)
- 느타리버섯, 표고버섯, 팽이버섯 (버섯 3개)
- 닭튀김당 (튀김 1개)
- 우유, 요구르트 (유제품 2개)

결과:
📊 전체 건강 점수: 4점
💚 건강한 재료 비율: 70%
✅ 매우 건강한 재료 조합입니다!
```

### 예시 2: 개별 재료 점수
| 재료 | 점수 | 평가 |
|------|------|------|
| 양배추 | 5점 | 💚 매우 건강 |
| 느타리버섯 | 5점 | 💚 매우 건강 |
| 브로콜리 | 5점 | 💚 매우 건강 |
| 당근 | 5점 | 💚 매우 건강 |
| 감자 | 4점 | 💚 건강 |
| 닭고기 | 3점 | 🟡 보통 |
| 우유 | 3점 | 🟡 보통 |
| 닭튀김당 | 1점 | 🔴 비건강 |

## 🔢 건강 점수 기준

### 💚 5점 - 매우 건강
**채소류:** 양배추, 브로콜리, 호박, 가지, 당근, 양파, 시금치, 배추, 상추
**버섯류:** 느타리버섯, 표고버섯, 팽이버섯, 새송이버섯
**해조류:** 김, 미역
**기타:** 마늘, 생강, 토마토, 오이, 무, 콩나물

**특징:** 영양소 풍부, 칼로리 낮음, 비타민/미네랄 많음

### 💚 4점 - 건강
**단백질:** 두부, 콩, 생선(고등어, 삼치, 연어)
**곡물:** 현미, 잡곡
**기타:** 감자, 고구마

**특징:** 단백질 풍부, 건강한 지방, 포만감 좋음

### 🟡 3점 - 보통
**단백질:** 닭고기, 계란, 소고기(안심)
**곡물:** 쌀
**유제품:** 우유, 요구르트
**조미료:** 고추장, 간장, 참기름

**특징:** 적당히 섭취 권장, 과하지 않게

### 🟠 2점 - 주의
**고기:** 돼지고기, 삼겹살, 목살, 소고기(등심)
**기타:** 치즈, 식용유, 소금

**특징:** 지방 많음, 칼로리 높음, 적게 섭취

### 🔴 1점 - 비건강
**가공식품:** 라면, 햄, 소시지, 베이컨
**튀김류:** 닭튀김, 치킨, 튀김
**기타:** 통조림, 설탕

**특징:** 가급적 피하세요, 건강에 해로움

## 🎨 UI 구성

### 1. 전체 점수 카드
```
┌─────────────────────────────┐
│    영수증 건강 점수          │
│         4점                  │
│     💚 건강                  │
│  건강한 재료 조합입니다!     │
└─────────────────────────────┘
```

### 2. 통계 카드
```
┌────────┐ ┌────────┐ ┌────────┐
│ 총 재료 │ │건강재료│ │  평균  │
│  17개  │ │  70%   │ │  4.1   │
└────────┘ └────────┘ └────────┘
```

### 3. 재료 목록 (체크박스)
```
☑ 양배추        [5점 💚 매우 건강]
☑ 브로콜리      [5점 💚 매우 건강]
☑ 닭고기        [3점 🟡 보통]
☐ 닭튀김당      [1점 🔴 비건강]
```

## 🔧 기술 구현

### 재료 점수 데이터베이스
```dart
// 200개 이상의 재료 점수 DB
static const Map<String, int> ingredientScores = {
  '양배추': 5,
  '브로콜리': 5,
  '닭고기': 3,
  '닭튀김당': 1,
  // ...
};
```

### 자동 매칭 알고리즘
```dart
// 부분 문자열 매칭
"닭" → "닭고기" 매칭
"버섯" → "느타리버섯" 매칭

// 카테고리 매칭
"무슨버섯" → 5점 (버섯류)
"튀김..." → 1점 (튀김류)
```

### 실시간 계산
```dart
// 평균 점수 계산
평균 = Σ(재료 점수) / 재료 개수

// 보너스 점수
if (채소+버섯 비율 >= 50%) {
  평균 += 0.5점
}

// 최종 점수 (1-5 범위)
최종 = round(평균).clamp(1, 5)
```

## 📱 사용 시나리오

### 시나리오 1: 장보고 와서 평가
1. 마트에서 장본 영수증 확인
2. 앱 실행 → "영수증 건강도 분석" 클릭
3. 재료 체크박스 선택
4. 즉시 건강 점수 확인
5. 건강하지 않은 재료는 다음부터 줄이기

### 시나리오 2: 요리 전 재료 평가
1. 오늘 요리할 재료 선택
2. "재료 건강도 분석" 클릭
3. 재료 입력 (양배추, 돼지고기, 고추장...)
4. 건강 점수 확인 (예: 3점)
5. 채소 추가로 점수 향상 (4점)

### 시나리오 3: 가족 식단 평가
1. 일주일 구매한 재료 전부 입력
2. 전체 건강 점수 확인
3. 건강한 재료 비율 확인 (목표: 60% 이상)
4. 다음주 장볼 때 개선

## 🚀 향후 개선

### Phase 1 (현재)
- ✅ 200개 이상 재료 점수 DB
- ✅ 자동 매칭 알고리즘
- ✅ 실시간 점수 계산
- ✅ 간편한 체크박스 UI
- ✅ 건강도 분석 리포트

### Phase 2 (예정)
- [ ] OCR로 영수증 자동 인식
- [ ] 사진 찍으면 재료 자동 추출
- [ ] 영수증 금액 기반 건강 투자 비율
- [ ] 주간/월간 건강도 트렌드
- [ ] 가족 구성원별 추천 점수

### Phase 3 (검토)
- [ ] AI 기반 재료 조합 추천
- [ ] 건강 점수 개선 제안
- [ ] 영양소 분석 (칼로리, 단백질 등)
- [ ] 레시피 자동 생성 (건강한 조합)

## 💬 사용자 피드백

### "너무 간편해요!"
> 체크박스만 누르면 바로 점수가 나와서 편리합니다.

### "건강한 장보기"
> 마트 가기 전에 미리 계획하고, 돌아와서 평가합니다. 점수가 올라가는 게 재미있어요!

### "가족 건강 챙기기"
> 아이들 간식 살 때 점수 확인하고 사니까 건강한 선택을 하게 되네요.

## 🔗 관련 기능

- [사용자 레시피 건강 점수](CUSTOM_RECIPE_INTEGRATION.md)
- [요리 추천 시스템](VOICE_ASSISTANT_INTEGRATION.md)
- [재료 유통기한 관리](../lib/screens/food_expiry_main_screen.dart)

## 📄 코드 위치

### 핵심 파일
- `lib/utils/ingredient_health_score_utils.dart` - 재료 점수 DB & 계산 로직
- `lib/screens/quick_health_analyzer_screen.dart` - 간편 분석 화면
- `lib/widgets/ingredient_health_analyzer_dialog.dart` - 커스텀 분석 다이얼로그
- `lib/widgets/recipe_health_score_widget.dart` - 레시피 점수 위젯

### 사용 예시
```dart
// 재료 점수 조회
final score = IngredientHealthScoreUtils.getScore('양배추'); // 5점

// 재료 목록 분석
final analysis = IngredientHealthScoreUtils.analyzeIngredients([
  '양배추', '브로콜리', '닭고기', '닭튀김당'
]);
print('전체 점수: ${analysis.overallScore}점'); // 4점
print('건강 재료: ${(analysis.healthyRatio * 100).toInt()}%'); // 50%

// 화면 열기
Navigator.push(
  context,
  MaterialPageRoute(builder: (_) => QuickHealthAnalyzerScreen()),
);
```

---

**만든 날:** 2026-01-10  
**버전:** 1.0.0  
**작성자:** GitHub Copilot
